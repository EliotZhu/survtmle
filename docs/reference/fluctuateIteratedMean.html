<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fluctuation for the Method of Iterated Means — fluctuateIteratedMean • survtmle</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fluctuation for the Method of Iterated Means — fluctuateIteratedMean" />
<meta property="og:description" content="This function performs a fluctuation of an initial estimate of the
G-computation regression at a specified time t using a call to
glm (i.e., a logistic submodel) or a call to optim (if bounds
are specified). The structure of the function is specific to how it is called
within mean_tmle. In particular, wideDataList must have a very
specific structure for this function to run properly. The list should consist
of data.frame objects. The first should have all rows set to their
observed value of trt. The remaining should in turn have all rows set
to each value of trtOfInterest in the survtmle call. The latter
will be used to obtain predictions that are then mapped into the estimates of
the cumulative incidence function at t0. Currently the code requires
each data.frame to have named columns for each name in
names(adjustVars), as well as a column named trt. It must also
have a columns named Nj.Y where j corresponds with the numeric values
input in allJ. These are the indicators of failure due to the various
causes before time t and are necessary for determining who to include
in the fluctuation regression. Similarly, each data.frame should have
a column call C.Y where Y is again t-1, so that right censored
observations are not included in the regressions. The function will fit a
logistic regression with Qj.star.t + 1 as outcome (also needed as a
column in wideDataList) with offset qlogis(Qj.star.t) and
number of additional covariates given by length(trtOfInterest). These
additional covariates should be columns in the each data.frame in
wideDataList called H.z.t where z corresponds to a each
unique value of trtOfInterest. The function returns the same
wideDataList, but with a column called Qj.star.t added to it,
which is the fluctuated initial regression estimate evaluated at the observed
data points." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">survtmle</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/survtmle_intro.html">Targeted Learning for Survival Analysis with Competing Risks</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/benkeser/survtmle">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fluctuation for the Method of Iterated Means</h1>
    <small class="dont-index">Source: <a href='https://github.com/benkeser/survtmle/blob/master/R/iterated_mean_fluctuate.R'><code>R/iterated_mean_fluctuate.R</code></a></small>
    <div class="hidden name"><code>fluctuateIteratedMean.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function performs a fluctuation of an initial estimate of the
G-computation regression at a specified time <code>t</code> using a call to
<code>glm</code> (i.e., a logistic submodel) or a call to <code>optim</code> (if bounds
are specified). The structure of the function is specific to how it is called
within <code>mean_tmle</code>. In particular, <code>wideDataList</code> must have a very
specific structure for this function to run properly. The list should consist
of <code>data.frame</code> objects. The first should have all rows set to their
observed value of <code>trt</code>. The remaining should in turn have all rows set
to each value of <code>trtOfInterest</code> in the <code>survtmle</code> call. The latter
will be used to obtain predictions that are then mapped into the estimates of
the cumulative incidence function at <code>t0</code>. Currently the code requires
each <code>data.frame</code> to have named columns for each name in
<code><a href='https://rdrr.io/r/base/names.html'>names(adjustVars)</a></code>, as well as a column named <code>trt</code>. It must also
have a columns named <code>Nj.Y</code> where j corresponds with the numeric values
input in <code>allJ</code>. These are the indicators of failure due to the various
causes before time <code>t</code> and are necessary for determining who to include
in the fluctuation regression. Similarly, each <code>data.frame</code> should have
a column call <code>C.Y</code> where Y is again <code>t-1</code>, so that right censored
observations are not included in the regressions. The function will fit a
logistic regression with <code>Qj.star.t + 1</code> as outcome (also needed as a
column in <code>wideDataList</code>) with offset <code><a href='https://rdrr.io/r/stats/Logistic.html'>qlogis(Qj.star.t)</a></code> and
number of additional covariates given by <code><a href='https://rdrr.io/r/base/length.html'>length(trtOfInterest)</a></code>. These
additional covariates should be columns in the each <code>data.frame</code> in
<code>wideDataList</code> called <code>H.z.t</code> where <code>z</code> corresponds to a each
unique value of <code>trtOfInterest</code>. The function returns the same
<code>wideDataList</code>, but with a column called <code>Qj.star.t</code> added to it,
which is the fluctuated initial regression estimate evaluated at the observed
data points.</p>
    </div>

    <pre class="usage"><span class='fu'>fluctuateIteratedMean</span>(
  <span class='no'>wideDataList</span>,
  <span class='no'>t</span>,
  <span class='no'>uniqtrt</span>,
  <span class='no'>whichJ</span>,
  <span class='no'>allJ</span>,
  <span class='no'>t0</span>,
  <span class='kw'>Gcomp</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>bounds</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>wideDataList</th>
      <td><p>A list of <code>data.frame</code> objects.</p></td>
    </tr>
    <tr>
      <th>t</th>
      <td><p>The timepoint at which to compute the iterated mean.</p></td>
    </tr>
    <tr>
      <th>uniqtrt</th>
      <td><p>The values of <code>trtOfInterest</code> passed to <code>mean_tmle</code>.</p></td>
    </tr>
    <tr>
      <th>whichJ</th>
      <td><p>Numeric value indicating the cause of failure for which
regression should be computed.</p></td>
    </tr>
    <tr>
      <th>allJ</th>
      <td><p>Numeric vector indicating the labels of all causes of failure.</p></td>
    </tr>
    <tr>
      <th>t0</th>
      <td><p>The timepoint at which <code>survtmle</code> was called to evaluate.
Needed only because the naming convention for the regression if
<code>t == t0</code> is different than if <code>t != t0</code>.</p></td>
    </tr>
    <tr>
      <th>Gcomp</th>
      <td><p>A boolean indicating whether <code>mean_tmle</code> was called to
evaluate the G-computation estimator, in which case this function does
nothing but re-label columns.</p></td>
    </tr>
    <tr>
      <th>bounds</th>
      <td><p>A list of bounds to be used when performing the outcome
regression (Q) with the Super Learner algorithm. NOT YET IMPLEMENTED.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments. Not currently used.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function then returns a list that is exactly the same as the
        input <code>wideDataList</code>, but with a column named <code>Qj.star.t</code>
        added to it, which is the fluctuated conditional mean of
        <code>Qj.star.t+1</code> evaluated at the each of the rows of each
        <code>data.frame</code> in <code>wideDataList</code>.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Benkeser, Nima Hejazi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


